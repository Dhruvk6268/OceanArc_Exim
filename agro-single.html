<html lang="en" class="page-anim">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title id="metaTitle">Product - OceanArc Exim</title>
  <meta name="description" id="metaDescription" content="Loading product details..." />
  <meta name="keywords" id="metaKeywords" content="Agricultural Products, OceanArc Exim" />
  <meta name="robots" content="index, follow" />

  <!-- Open Graph -->
  <meta property="og:title" id="ogTitle" content="Product - OceanArc Exim" />
  <meta property="og:description" id="ogDescription" content="Loading product details..." />
  <meta property="og:type" content="product" />
  <meta property="og:url" id="ogUrl" content="https://oceanarcexim.com/product-single.html" />
  <meta property="og:image" id="ogImage" content="https://oceanarcexim.com/images/og-product.jpg" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" id="twitterTitle" content="Product - OceanArc Exim" />
  <meta name="twitter:description" id="twitterDescription" content="Loading product details..." />
  <meta name="twitter:image" id="twitterImage" content="https://oceanarcexim.com/images/og-product.jpg" />

  <!-- Canonical -->
  <link rel="canonical" id="canonicalLink" href="https://oceanarcexim.com/product-single.html" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
  <link rel="stylesheet" href="css/style.css" />
  <link rel="icon" href="images/logo.svg" type="image/svg+xml">

  <style>
    /* Product Page CSS */
    .product-page {
      padding: 60px 0;
      position: relative;
    }

    .product-container {
      max-width: 1600px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 2fr 2fr;
      gap: 30px;
    }

    /* HIGH SPECIFICITY FOR STICKY SCROLL BEHAVIOR */
    .product-page .product-image-section {
      position: sticky !important;
      top: 120px !important;
      align-self: start !important;
      height: min-content !important;
      transition: all 0.3s ease !important;
      z-index: 10 !important;
    }

    .product-image {
      width: 100%;
      height: 450px;
      object-fit: cover;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .product-title {
      font-size: 2.5rem;
      color: var(--primary-color);
      margin-bottom: 15px;
    }

    .product-category {
      display: inline-block;
      background-color: var(--light-color);
      padding: 5px 15px;
      border-radius: 20px;
      margin-bottom: 20px;
      font-size: 0.9rem;
    }

    .product-description {
      font-size: 1.1rem;
      line-height: 1.8;
      margin-bottom: 30px;
    }

    .product-specs {
      margin-bottom: 30px;
    }

    .product-specs h3 {
      margin-bottom: 15px;
      font-size: 1.3rem;
    }

    .product-specs ul {
      list-style-type: none;
      padding: 0;
    }

    .product-specs li {
      padding: 8px 0;
      border-bottom: 1px solid #eee;
    }

    .product-specs li:last-child {
      border-bottom: none;
    }

    .product-content {
      line-height: 1.8;
      margin-top: -30px;
    }

    .loading-spinner {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 40px;
      grid-column: 1/-1;
    }

    .spinner {
      border: 4px solid rgba(0, 0, 0, 0.1);
      border-left: 4px solid var(--primary-color);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    .error-message {
      text-align: center;
      padding: 40px;
      grid-column: 1/-1;
    }

    .error-message i {
      font-size: 3rem;
      color: #ff6b6b;
      margin-bottom: 20px;
    }

    .btn {
      display: inline-block;
      background: var(--primary-color);
      color: white;
      padding: 12px 25px;
      border-radius: 5px;
      text-decoration: none;
      font-weight: 600;
      margin-top: 20px;
      transition: background 0.3s ease;
    }

    .btn:hover {
      background: var(--primary-dark);
    }

    /* Back to Products Button */
    .back-to-products {
      display: inline-flex;
      align-items: center;
      margin-bottom: 30px;
      color: var(--primary-color);
      text-decoration: none;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .back-to-products i {
      margin-right: 8px;
      transition: transform 0.3s ease;
    }

    .back-to-products:hover {
      color: var(--primary-dark);
    }

    .back-to-products:hover i {
      transform: translateX(-5px);
    }

    /* Other Products Section */
    .other-products {
      margin-top: 80px;
      padding-top: 60px;
      border-top: 1px solid #eee;
    }

    .other-products h2 {
      font-size: 2rem;
      color: var(--primary-color);
      margin-bottom: 40px;
      text-align: center;
      position: relative;
    }

    .other-products h2::after {
      content: '';
      display: block;
      width: 60px;
      height: 3px;
      background-color: #f58220;
      margin: 15px auto 0 auto;
      border-radius: 2px;
    }

    .other-products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 30px;
      margin-top: 30px;
    }

    /* Enhanced Product Card Design */
    .other-products .product-card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      transition: all 0.3s ease;
      border: 1px solid #f0f0f0;
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    .other-products .product-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
      border-color: var(--primary-color);
    }

    .other-products .product-image {
      width: 100%;
      height: 300px;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      transition: transform 0.3s ease;
    }

    .other-products .product-card:hover .product-image {
      transform: scale(1.05);
    }

    .other-products .product-content {
      padding: 25px;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }

    .other-products .product-content h3 {
      font-size: 1.3rem;
      color: var(--primary-color);
      margin-bottom: 12px;
      font-weight: 600;
      line-height: 1.4;
    }

    .other-products .product-category {
      display: inline-block;
      background: linear-gradient(135deg, #f58220, #ff9e45);
      color: white;
      padding: 4px 12px;
      border-radius: 15px;
      font-size: 0.8rem;
      font-weight: 500;
      margin-bottom: 15px;
      align-self: flex-start;
    }

    .other-products .product-content p {
      color: #666;
      line-height: 1.6;
      margin-bottom: 20px;
      flex-grow: 1;
      font-size: 0.95rem;
    }

    .other-products .learn-more {
      display: inline-flex;
      align-items: center;
      color: var(--primary-color);
      font-weight: 600;
      text-decoration: none;
      transition: all 0.3s ease;
      margin-top: auto;
      font-size: 0.95rem;
    }

    .other-products .learn-more i {
      margin-left: 8px;
      transition: transform 0.3s ease;
      font-size: 0.9rem;
    }

    .other-products .learn-more:hover {
      color: var(--primary-dark);
    }

    .other-products .learn-more:hover i {
      transform: translateX(4px);
    }

    .other-products .learn {
      text-decoration: none;
      color: inherit;
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    /* Responsive Media Heights */
    @media(max-width: 768px) {

      .product-image,
      .product-media {
        height: 300px !important;
      }

      .other-products .product-image,
      .other-products video {
        height: 200px !important;
      }
    }

    @media(max-width: 1200px) {
      .other-products-grid {
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 25px;
      }
    }

    /* HIGH SPECIFICITY RESPONSIVE STYLES */
    @media(max-width: 992px) {
      .product-page .product-container {
        grid-template-columns: 1fr !important;
      }

      .product-page .product-image-section {
        position: relative !important;
        top: 0 !important;
        width: 100% !important;
      }

      .product-title {
        font-size: 2rem;
      }

      .product-image {
        height: 300px;
      }

      .other-products h2 {
        font-size: 1.5rem;
      }

      .other-products-grid {
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
      }

      .other-products .product-content {
        padding: 20px;
      }

      .other-products .product-content h3 {
        font-Size: 1.2rem;
      }
    }

    @media(max-width: 480px) {
      .other-products-grid {
        grid-template-columns: 1fr;
        gap: 20px;
      }

      .other-products {
        margin-top: 60px;
        padding-top: 40px;
      }
    }
  </style>
  <!-- Initial JSON-LD -->
  <script type="application/ld+json" id="productJsonLd">
  {
    "@context": "https://schema.org/",
    "@type": "Product",
    "name": "Loading product...",
    "image": "https://oceanarcexim.com/images/og-product.jpg",
    "description": "Loading product details...",
    "brand": { "@type": "Brand", "name": "OceanArc Exim" },
    "offers": {
      "@type": "Offer",
      "url": "https://oceanarcexim.com/product-single.html",
      "priceCurrency": "INR",
      "availability": "https://schema.org/InStock"
    }
  }
  </script>
</head>

<body>
  <!-- Header -->
  <header>
    <div class="container header-container">
      <a href="https://oceanarcexim.com/" class="logo" style="text-decoration:none;color:inherit;">
        Ocean<span>Arc</span> Exim
        <div class="tagline">Connect the world, seamlessly</div>
      </a>
      <button class="nav-toggle" id="navToggle"><i class="fas fa-bars"></i></button>
      <nav id="mainNav">
        <ul>
          <li><a href="https://oceanarcexim.com/">Home</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="service.html">Services</a></li>
          <li class="dropdown">
            <a href="" style="color: #ff9900;">Products</a>
            <div class="dropdown-menu">
              <a href="agro-products.html" style="color: #ff9900;">Agriculture</a>
              <a href="garments.html">Garments</a>
            </div>
          </li>
          <li><a href="blog.html">Blog</a></li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>
  <!-- WhatsApp Button -->
  <a href="https://wa.me/917096200535?text=Hi%20OceanArc%20Exim!%20Let's%20connect." class="whatsapp-button"
    target="_blank" aria-label="Chat with us on WhatsApp">
    <i class="fab fa-whatsapp"></i>
  </a>
  <!-- Product Page -->
  <main class="product-page">
    <div class="container">
      <!-- Back to Products Button -->
      <a href="agro-products.html" class="back-to-products">
        <i class="fas fa-arrow-left"></i> Back to Products
      </a>

      <div class="product-container" id="productContainer">
        <div class="loading-spinner">
          <div class="spinner"></div>
          <p>Loading product details...</p>
        </div>
      </div>

      <!-- Other Products Section -->
      <section class="other-products" id="otherProducts">
        <h2>Other Products You Might Like</h2>
        <div class="other-products-grid" id="otherProductsGrid">
          <div class="loading-spinner">
            <div class="spinner"></div>
            <p>Loading other products...</p>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- Footer -->
  <footer>
    <div class="container">
      <div class="footer-container">
        <div class="footer-column">
          <h3>OceanArc Exim</h3>
          <p>Connect the world, seamlessly through quality agriculture products and global trade solutions.</p>
          <div class="social-links">
            <a href="https://www.facebook.com/profile.php?id=61581010155384" target="_blank"><i
                class="fab fa-facebook-f"></i></a>
            <a href="https://x.com/oceanarcexim" target="_blank"><i class="fab fa-x-twitter"></i></a>
            <a href="https://www.linkedin.com/company/oceanarc-exim/" target="_blank"><i
                class="fab fa-linkedin-in"></i></a>
            <a href="https://www.instagram.com/oceanarcexim/" target="_blank"><i class="fab fa-instagram"></i></a>
          </div>
        </div>
        <div class="footer-column">
          <h3>Quick Links</h3>
          <ul class="footer-links">
            <li><a href="https://oceanarcexim.com/">Home</a></li>
            <li><a href="about.html">About Us</a></li>
            <li><a href="service.html">Services</a></li>
            <li><a href="agro-products.html">Products</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h3>Products</h3>
          <ul class="footer-links">
            <li><a href="https://oceanarcexim.com/agro-single.html?basmati-rice">Rice</a></li>
            <li>
              <a href="garments.html">Garment</a>
            </li>
            <li><a href="https://oceanarcexim.com/agro-single.html?moringa-powder">Moringa Powder</a></li>
            <li><a href="https://oceanarcexim.com/agro-single.html?pulses">Pulses</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h3>Contact Us</h3>
          <ul class="contact-info">
            <li><a href="https://www.google.com/maps?q=Surat,+Gujarat,+India" target="_blank"><i
                  class="fas fa-map-marker-alt"></i> Surat, Gujarat, India</a></li>
            <li><a href="tel:+917096200535"><i class="fas fa-phone-alt"></i> +91 70962 00535</a></li>
            <li><a href="mailto:contact@oceanarcexim.com"><i class="fas fa-envelope"></i> contact@oceanarcexim.com</a>
            </li>
          </ul>
        </div>
      </div>
      <div class="copyright">
        <p>&copy; 2025 OceanArc Exim. All Rights Reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Dynamic Product Loader -->
 <script>
  document.addEventListener("DOMContentLoaded", function () {
    const urlParams = new URLSearchParams(window.location.search);
    const productId = urlParams.get("id");
    const productSlug = urlParams.get("slug");
    const container = document.getElementById("productContainer");
    const otherProductsGrid = document.getElementById("otherProductsGrid");

    // Check for direct parameter (like ?rice-exporter-india)
    let directParam = null;
    const paramKeys = Array.from(urlParams.keys());
    
    // Find first parameter that's not 'id' or 'slug'
    for (const key of paramKeys) {
      if (key !== 'id' && key !== 'slug') {
        directParam = key;
        break;
      }
    }

    if (!productSlug && !productId && !directParam) {
      container.innerHTML = `<div class="error-message"><i class="fas fa-exclamation-triangle"></i><h3>No product specified</h3><a href="agro-products.html" class="btn">View Our Products</a></div>`;
      document.getElementById('otherProducts').style.display = 'none';
      return;
    }

    // Determine fetch URL based on available parameters
    let fetchUrl;
    if (directParam) {
      // Direct parameter like ?rice-exporter-india
      fetchUrl = `php/get-product.php?slug=${encodeURIComponent(directParam)}`;
    } else if (productSlug) {
      // Standard slug parameter
      fetchUrl = `php/get-product.php?slug=${encodeURIComponent(productSlug)}`;
    } else {
      // ID parameter (backward compatibility)
      fetchUrl = `php/get-product.php?id=${productId}`;
    }

    // Load main product
    fetch(fetchUrl)
      .then(res => res.json())
      .then(product => {
        if (product.error) throw new Error(product.error);
        
        // Clean the URL to show just the slug without "slug="
        if (product.slug) {
          cleanURL(product.slug);
        }
        
        // Render product
        let specsHtml = "";
        if (product.specifications) {
          const specsList = product.specifications.split("\n").filter(s => s.trim() !== "");
          if (specsList.length > 0) {
            specsHtml = `<div class="product-specs"><h3>Specifications</h3><ul>${specsList.map(s => `<li>${s}</li>`).join("")}</ul></div>`;
          }
        }

        // Get responsive height
        const isMobile = window.innerWidth <= 768;
        const mainMediaHeight = isMobile ? '300px' : '450px';
        const thumbnailHeight = '120px';

        container.innerHTML = `
          <div class="product-image-section">
            <!-- Main Media Display -->
            <div class="main-media">
              ${product.video && product.video.trim() !== '' ?
                `<video id="mainVideo" class="product-media" autoplay muted loop playsinline style="width:100%; height:${mainMediaHeight}; object-fit:cover; border-radius:8px; box-shadow:0 5px 15px rgba(0,0,0,0.1);">
                   <source src="${product.video}" type="video/mp4">
                   Your browser does not support the video tag.
                 </video>` :
                product.image && product.image.trim() !== '' ?
                  `<img src="${product.image}" alt="${product.title}" class="product-image" style="width:100%; height:${mainMediaHeight}; object-fit:cover; border-radius:8px; box-shadow:0 5px 15px rgba(0,0,0,0.1);" />` :
                  `<div class="no-media-placeholder" style="width:100%; height:${mainMediaHeight}; background:#f5f5f5; border-radius:8px; display:flex; align-items:center; justify-content:center; color:#666;">
                     <i class="fas fa-image" style="font-size:3rem;"></i>
                   </div>`
              }
            </div>
            
            <!-- Additional Media Section -->
            ${(product.video && product.video.trim() !== '' && product.image && product.image.trim() !== '') ?
                `<div class="additional-media" style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee;">
                   <div class="media-gallery" style="display: flex; gap: 15px; flex-wrap: wrap;">
                     <!-- Video Thumbnail -->
                     <div class="media-item" style="flex: 0 0 auto;">
                       <video class="media-thumbnail" 
                              style="width:${thumbnailHeight}; height:${thumbnailHeight}; object-fit:cover; border-radius:6px; border:2px solid #ddd; cursor:pointer;"
                              onclick="switchToVideo()"
                              muted loop playsinline>
                         <source src="${product.video}" type="video/mp4">
                       </video>
                       <p style="text-align:center; margin-top:5px; font-size:0.8rem; color:#666;">Video</p>
                     </div>
                     
                     <!-- Image Thumbnail -->
                     <div class="media-item" style="flex: 0 0 auto;">
                       <img src="${product.image}" alt="${product.title}" 
                            style="width:${thumbnailHeight}; height:${thumbnailHeight}; object-fit:cover; border-radius:6px; border:2px solid #f58220; cursor:pointer;"
                            onclick="switchToImage()" />
                       <p style="text-align:center; margin-top:5px; font-size:0.8rem; color:#666;">Image</p>
                     </div>
                   </div>
                 </div>` :
                ''
            }
          </div>
          <div>
            ${specsHtml}
            <div class="product-content" id="dynamicContent">${product.content || ""}</div>
          </div>
        `;

        // Initialize scroll behavior after product is rendered
        setTimeout(initScrollBehavior, 300);

        // Add responsive media handling functions
        function updateMediaHeights() {
          const isMobile = window.innerWidth <= 768;
          const targetHeight = isMobile ? '300px' : '450px';

          // Update main media
          const mainMedia = document.querySelector('.main-media');
          if (mainMedia) {
            const mediaElement = mainMedia.querySelector('video, img');
            if (mediaElement) {
              mediaElement.style.height = targetHeight;
            }
          }
        }

        // Add switch functions if both media exist
        if (product.video && product.video.trim() !== '' && product.image && product.image.trim() !== '') {
          // Store media elements for switching
          window.productMedia = {
            video: product.video,
            image: product.image,
            title: product.title
          };

          // Function to switch to video as main media
          window.switchToVideo = function () {
            const mainMedia = document.querySelector('.main-media');
            const isMobile = window.innerWidth <= 768;
            const targetHeight = isMobile ? '300px' : '450px';

            mainMedia.innerHTML = `
              <video id="mainVideo" class="product-media" autoplay muted loop playsinline style="width:100%; height:${targetHeight}; object-fit:cover; border-radius:8px; box-shadow:0 5px 15px rgba(0,0,0,0.1);">
                <source src="${window.productMedia.video}" type="video/mp4">
                Your browser does not support the video tag.
              </video>
            `;

            // Update thumbnail borders
            document.querySelectorAll('.media-thumbnail').forEach(thumb => {
              thumb.style.border = '2px solid #ddd';
            });
            document.querySelectorAll('.media-item img').forEach(img => {
              img.style.border = '2px solid #f58220';
            });
          };

          // Function to switch to image as main media
          window.switchToImage = function () {
            const mainMedia = document.querySelector('.main-media');
            const isMobile = window.innerWidth <= 768;
            const targetHeight = isMobile ? '300px' : '450px';

            mainMedia.innerHTML = `
              <img src="${window.productMedia.image}" alt="${window.productMedia.title}" 
                   style="width:100%; height:${targetHeight}; object-fit:cover; border-radius:8px; box-shadow:0 5px 15px rgba(0,0,0,0.1);" />
            `;

            // Update thumbnail borders
            document.querySelectorAll('.media-thumbnail').forEach(thumb => {
              thumb.style.border = '2px solid #f58220';
            });
            document.querySelectorAll('.media-item img').forEach(img => {
              img.style.border = '2px solid #ddd';
            });
          };
        }

        // Initialize heights and add resize listener
        setTimeout(updateMediaHeights, 100);
        window.addEventListener('resize', updateMediaHeights);

        // Execute any scripts in the dynamic content
        executeDynamicScripts();

        // Update SEO meta
        document.getElementById("metaTitle").textContent = `${product.title} | OceanArc Exim`;
        document.getElementById("metaDescription").setAttribute("content", product.description || "");
        document.getElementById("metaKeywords").setAttribute("content", `${product.title}, ${product.category || ""}, Agricultural Products, OceanArc Exim`);
        document.getElementById("ogTitle").setAttribute("content", product.title);
        document.getElementById("ogDescription").setAttribute("content", product.description || "");
        document.getElementById("ogUrl").setAttribute("content", window.location.href);
        document.getElementById("ogImage").setAttribute("content", product.image);
        document.getElementById("twitterTitle").setAttribute("content", product.title);
        document.getElementById("twitterDescription").setAttribute("content", product.description || "");
        document.getElementById("twitterImage").setAttribute("content", product.image);
        document.getElementById("canonicalLink").setAttribute("href", window.location.href);

        // Update JSON-LD
        const jsonLd = {
          "@context": "https://schema.org/",
          "@type": "Product",
          "name": product.title,
          "image": product.image,
          "description": product.description || "",
          "brand": { "@type": "Brand", "name": "OceanArc Exim" },
          "offers": {
            "@type": "Offer",
            "url": window.location.href,
            "priceCurrency": "INR",
            "availability": "https://schema.org/InStock"
          }
        };
        document.getElementById("productJsonLd").textContent = JSON.stringify(jsonLd);

        // Load other products (excluding current product)
        loadOtherProducts(product.id, product.slug);
      })
      .catch(err => {
        console.error(err);
        container.innerHTML = `<div class="error-message"><i class="fas fa-exclamation-triangle"></i><h3>${err.message || "Failed to load product"}</h3><a href="agro-products.html" class="btn">View Our Products</a></div>`;
        document.getElementById('otherProducts').style.display = 'none';
      });

    function cleanURL(slug) {
      if (!slug) return;
      
      // Create a clean URL with just the slug as parameter (no "slug=")
      const cleanUrl = `${window.location.pathname}?${slug}`;
      const cleanTitle = `${document.title} - OceanArc Exim Products`;
      
      // Store current URL in sessionStorage for page refresh
      sessionStorage.setItem('lastProductSlug', slug);
      
      // Update browser history without page reload
      window.history.replaceState(
        { 
          clean: true,
          hasProduct: true,
          slug: slug,
          timestamp: Date.now()
        },
        cleanTitle,
        cleanUrl
      );
      
      // Update SEO meta tags
      updateCanonicalURL(cleanUrl);
      
      // Handle back/forward navigation
      window.addEventListener('popstate', function(event) {
        if (event.state && event.state.clean && event.state.slug) {
          // User navigated back/forward, maintain clean URL
          const backUrl = `${window.location.pathname}?${event.state.slug}`;
          window.history.replaceState(
            { 
              clean: true,
              hasProduct: true,
              slug: event.state.slug,
              timestamp: event.state.timestamp
            },
            document.title,
            backUrl
          );
        }
      });
    }

    function updateCanonicalURL(url) {
      // Update canonical URL
      const canonicalLink = document.querySelector('link[rel="canonical"]');
      if (canonicalLink) {
        canonicalLink.href = url;
      }
      
      // Update Open Graph URL
      const ogUrl = document.getElementById('og-url');
      if (ogUrl) {
        ogUrl.content = url;
      }
    }

    function loadOtherProducts(currentProductId, currentProductSlug) {
      fetch('php/get-products.php')
        .then(res => res.json())
        .then(products => {
          // Filter out current product and limit to 4 other products
          const otherProducts = products
            .filter(product => product.id != currentProductId && product.slug != currentProductSlug)
            .slice(0, 4);

          if (otherProducts.length > 0) {
            renderOtherProducts(otherProducts);
          } else {
            otherProductsGrid.innerHTML = '<p>No other products available.</p>';
          }
        })
        .catch(error => {
          console.error('Error loading other products:', error);
          otherProductsGrid.innerHTML = `
            <div class="error-message">
              <p>Failed to load other products. Please try again later.</p>
            </div>
          `;
        });
    }

    function renderOtherProducts(products) {
      otherProductsGrid.innerHTML = '';

      // Get responsive height for other products
      const isMobile = window.innerWidth <= 768;
      const mediaHeight = isMobile ? '200px' : '300px';

      products.forEach(product => {
        const productElement = document.createElement('div');
        productElement.className = 'product-card';

        // Check if product has video
        const hasVideo = product.video && product.video.trim() !== '';

        const mediaContent = hasVideo ?
          `<video class="product-media" autoplay muted loop playsinline style="width:100%; height:${mediaHeight}; object-fit:cover;">
           <source src="${product.video}" type="video/mp4">
           Your browser does not support the video tag.
         </video>` :
          `<div class="product-image" style="background-image: url('${product.image || 'images/product-placeholder.jpg'}'); height: ${mediaHeight};"></div>`;

        // Use slug for URL if available, otherwise fall back to ID
        const productUrl = product.slug ? 
          `agro-single.html?${encodeURIComponent(product.slug)}` : 
          `agro-single.html?id=${product.id}`;

        productElement.innerHTML = `
          <a href="${productUrl}" class="learn">
            ${mediaContent}
            <div class="product-content">
              <h3>${product.title}</h3>
              ${product.category ? `<span class="product-category">${product.category}</span>` : ''}
              <p>${product.description || (product.content ? product.content.substring(0, 100) : '')}...</p>
              <div class="learn-more">View Details <i class="fas fa-arrow-right"></i></div>
            </div>
          </a>
        `;
        otherProductsGrid.appendChild(productElement);
      });

      // Add resize listener for other products
      function updateOtherProductsHeights() {
        const isMobile = window.innerWidth <= 768;
        const targetHeight = isMobile ? '200px' : '300px';

        document.querySelectorAll('.other-products video, .other-products .product-image').forEach(media => {
          media.style.height = targetHeight;
        });
      }

      window.addEventListener('resize', updateOtherProductsHeights);
    }

    // Function to execute scripts in dynamic content
    function executeDynamicScripts() {
      const dynamicContent = document.getElementById('dynamicContent');
      if (!dynamicContent) return;

      // Find all script tags in the dynamic content
      const scripts = dynamicContent.getElementsByTagName('script');

      // Convert to array and execute each script
      Array.from(scripts).forEach(script => {
        try {
          // Create a new script element
          const newScript = document.createElement('script');

          // Copy attributes
          for (let attr of script.attributes) {
            newScript.setAttribute(attr.name, attr.value);
          }

          // Copy content if it's an inline script
          if (script.textContent) {
            newScript.textContent = script.textContent;
          }

          // Remove the original script
          script.parentNode.removeChild(script);

          // Add the new script to the document head to execute it
          document.head.appendChild(newScript);
        } catch (e) {
          console.error('Error executing dynamic script:', e);
        }
      });
    }

    // Scroll behavior function
    function initScrollBehavior() {
      const imageSection = document.querySelector('.product-image-section');
      const contentSection = document.querySelector('.product-content');
      const footer = document.querySelector('footer');
      
      if (!imageSection || !contentSection || !footer) {
        console.log('Required elements not found for scroll behavior');
        return;
      }
      
      console.log('Initializing product scroll behavior...');
      
      // Force the sticky positioning
      imageSection.style.position = 'sticky';
      imageSection.style.top = '120px';
      imageSection.style.zIndex = '10';
      
      function updateScrollPosition() {
        const scrollPosition = window.scrollY;
        const headerHeight = 100;
        const footerOffset = footer.offsetTop;
        const imageHeight = imageSection.offsetHeight;
        const contentBottom = contentSection.offsetTop + contentSection.offsetHeight;
        
        // Calculate the maximum scroll position where image should stop being sticky
        const maxScrollPosition = Math.min(footerOffset - imageHeight - 100, contentBottom - imageHeight - 100);
        
        // Only apply scroll behavior on larger screens
        if (window.innerWidth > 992) {
          if (scrollPosition > headerHeight) {
            // If we haven't reached the bottom of the content
            if (scrollPosition < maxScrollPosition) {
              // Keep the image sticky
              imageSection.style.position = 'sticky';
              imageSection.style.top = '120px';
            } else {
              // Stop the sticky behavior and let the image scroll normally
              imageSection.style.position = 'relative';
              imageSection.style.top = 'auto';
            }
          } else {
            // Reset to initial state when at the top
            imageSection.style.position = 'sticky';
            imageSection.style.top = '120px';
          }
        } else {
          // Reset for mobile
          imageSection.style.position = 'static';
          imageSection.style.top = 'auto';
        }
      }
      
      // Initial call
      updateScrollPosition();
      
      // Throttled scroll event
      let scrollTimeout;
      window.addEventListener('scroll', function() {
        if (!scrollTimeout) {
          scrollTimeout = setTimeout(function() {
            scrollTimeout = null;
            updateScrollPosition();
          }, 16); // ~60fps
        }
      });
      
      // Recalculate on resize
      window.addEventListener('resize', function() {
        setTimeout(updateScrollPosition, 100);
      });
      
      // Recalculate when images load
      const images = document.querySelectorAll('img');
      images.forEach(img => {
        img.addEventListener('load', function() {
          setTimeout(updateScrollPosition, 100);
        });
      });
    }
  });
</script>

  <script src="/js/main.js"></script>
</body>

</html>
